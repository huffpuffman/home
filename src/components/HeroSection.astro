---
const { title = "Tyler Huffman", subtitle = "Tyler Huffman Â· Composer Â· Visionary" } = Astro.props;
const audioSrc = 'audio/fear-tyler-huffman.wav';
const videoSrc = 'video/Fear_TylerHuffman(2020).MP4';
---

<!--------  HERO  -------->

<section id="hero" class="relative h-screen overflow-hidden flex items-center justify-center text-center">

  <!-- Hero Background Video Source -->
  <video id="bgVideo" autoplay muted loop playsinline class="absolute inset-0 w-full h-full object-cover opacity-100 transition-opacity duration-1000 ease-in-out">
    <source src={videoSrc} type="video/mp4"/>
    Your browser does not support the video tag.
  </video>

  <!-- Hero Overlay -->
  <div class="absolute inset-0 bg-gradient-to-b from-black/90 to-primary/50 z-10 pointer-events-none"></div>

  <!-- Hero Content -->
  <div class="z-10 relative max-w-3xl mx-auto px-6">
    <h1 class="text-5xl md:text-7xl lg:text-8xl  text-gold drop-shadow-lg">{title}</h1>
    <p class="mt-2 text-lg md:text-2xl lg:text-3xl  text-cream">{subtitle}</p>

  <!-- Social Media Links -->
  <div class="mt-16 flex justify-center gap-6 z-10">
    <!-- SoundCloud -->
    <a href="https://soundcloud.com/tylerhuffman" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M16.77 12.46c-.16-.33-.36-.65-.59-.95-.2-.25-.43-.48-.68-.68-.38-.27-.8-.44-1.25-.44H5.37C4.92 11.39 4.5 11.56 4.12 11.83c-.25.14-.5.3-.72.5-.2.18-.36.4-.47.64-.14.27-.21.56-.21.87 0 .37.11.72.33 1.02.21.3.5.55.83.74.35.2.74.3 1.13.3h7.05c.7 0 1.36-.25 1.87-.68.48-.38.8-.88.94-1.47.12-.52.06-1.06-.19-1.55z"/>
      </svg>
    </a>
    <!-- Instagram -->
    <a href="https://www.instagram.com/huffpuffman" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 2C5.678 4 4 5.678 4 7.75v8.5C4 18.322 5.678 20 7.75 20h8.5C18.322 20 20 18.322 20 16.25v-8.5C20 5.678 18.322 4 16.25 4h-8.5zM12 7a5 5 0 1 1 0 10a5 5 0 0 1 0-10zm0 2a3 3 0 1 0 0 6a3 3 0 0 0 0-6zm4.5-.25a1.25 1.25 0 1 1 0 2.5a1.25 1.25 0 0 1 0-2.5z"/>
      </svg>
    </a>
    <!-- Facebook -->
    <a href="https://www.facebook.com/tylerhuffman" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M22.675 0H1.325C.593 0 0 .593 0 1.326v21.348C0 23.407.593 24 1.325 24h11.494v-9.294H9.691V11.01h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788c1.325 0 2.464.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.312h3.587l-.467 3.696h-3.12V24h6.116C23.407 24 24 23.407 24 22.674V1.326C24 .593 23.407 0 22.675 0z"/>
      </svg>
    </a>
    <!-- LinkedIn -->
    <a href="https://www.linkedin.com/in/tylerhuffman" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.039-1.849-3.039c-1.851 0-2.135 1.445-2.135 2.941v5.667h-3.554V9h3.414v1.561h.049c.476-.9 1.637-1.849 3.372-1.849c3.606 0 4.272 2.373 4.272 5.459v6.281zM5.337 7.433c-1.144 0-2.069-.926-2.069-2.069c0-1.144.925-2.069 2.069-2.069c1.143 0 2.068.925 2.068 2.069c0 1.143-.925 2.069-2.068 2.069zM6.814 20.452H3.861V9h2.953v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.207 24 24 23.227 24 22.271V1.729C24 .774 23.207 0 22.225 0z"/>
      </svg>
    </a>
    <!-- TikTok -->
    <a href="https://www.tiktok.com/@tylerhuffman" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12.004 2.158a5.507 5.507 0 0 0-5.507 5.507v8.785a3.342 3.342 0 1 0 3.342-3.342V8.665a1.173 1.173 0 0 1 1.173-1.173h2.967a3.34 3.34 0 1 0 3.34 3.34v7.064a4.512 4.512 0 1 1-4.512-4.512v-2.875z"/>
      </svg>
    </a>
  
    <!-- Commented Out: Additional Social Icons (enable when ready) -->
    <!--
    <a href="https://open.spotify.com/artist/your-artist-id" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2z"/>
      </svg>
    </a>
    <a href="https://www.youtube.com/channel/your-channel-id" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M19.615 3.184A3.004 3.004 0 0 0 17.11 2H6.89a3.004 3.004 0 0 0-2.505 1.184A3.004 3.004 0 0 0 3 5.685v12.63a3.004 3.004 0 0 0 1.385 2.5A3.004 3.004 0 0 0 6.89 22h10.22a3.004 3.004 0 0 0 2.505-1.184A3.004 3.004 0 0 0 21 18.315V5.685a3.004 3.004 0 0 0-1.385-2.5zM10 15V9l5 3-5 3z"/>
      </svg>
    </a>
    <a href="https://twitter.com/your-twitter-handle" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
      </svg>
    </a>
    <a href="https://yourbandcampurl.com" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2z"/>
      </svg>
    </a>
    <a href="https://www.patreon.com/your-patreon" target="_blank" rel="noopener noreferrer" class="hover:text-gold transition duration-300">
      <svg class="w-12 h-12 text-cream hover:scale-110" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2z"/>
      </svg>
    </a>
    -->
  </div>

<!-- Play Button -->
    <button id="heroPlayBtn" class="mt-96 px-36 py-6 rounded-full bg-gold  text-primary text-5xl font-extrabold shadow-3xl
    mix-blend-mode: lighten;
    hover:bg-opacity-80
    hover:bg-cream
    hover:transition-duration-300
    hover:shadow-3xl"
    style="mix-blend-mode: lighten;">
      Play
    </button>
  </div>

<!-- ^^^ End of Visible Hero Content ^^^ -->
 

<!------ Background Video/Audio ------>

  <!-- ðŸŽ§ Audio -->
  <audio id="heroAudio" src={audioSrc} preload="auto" class="hidden"></audio>

  <!-- ðŸ§  Audio + Glitch Script -->
  <script type="module">
    const audio = document.getElementById("heroAudio");
    const video = document.getElementById("bgVideo");
    const btn = document.getElementById("heroPlayBtn");

    let audioCtx;
    let analyser;
    let dataArray;
    let rafId;

    //Initial video
    //video.style.scale = 1.6;

    btn.addEventListener("click", async () => {
      if (!audioCtx) {
        audioCtx = new AudioContext();
        const source = audioCtx.createMediaElementSource(audio);
        analyser = audioCtx.createAnalyser();
        analyser.fftSize = 256;
        source.connect(analyser);
        analyser.connect(audioCtx.destination);
        dataArray = new Uint8Array(analyser.frequencyBinCount);
        animateGlitch();

      }

      if (audio.paused) {
        await audioCtx.resume();
        audio.play();
        btn.textContent = "Pause";
      } else {
        audio.pause();
        cancelAnimationFrame(rafId);
        btn.textContent = "Play";
        video.style.transform = "none";
        video.style.filter = "none";
        video.style.scale = 1.6;
        animateGlitch()


  
      }
    });

    function animateGlitch() {
      rafId = requestAnimationFrame(animateGlitch);

      if (!analyser || !dataArray) return;
      analyser.getByteFrequencyData(dataArray);

      const avg = dataArray.reduce((a, b) => a + b, 0) / dataArray.length;
      const intensity = Math.min(avg / 10, 50); // Clamp for sanity

      const shakeX = (Math.random() * 1.5) * intensity;
      const shakeY = (Math.random() * 1.5) * intensity;
      const rotate = (Math.random() * 0.5) * (intensity / 4);

      video.style.transform = `translate(${shakeX}px, ${shakeY}px)`;
      video.style.scale = 1 + (intensity / 30);
      video.style.rotate = `${rotate}deg`;
      video.style.transition = "transform 0.1s ease-out, filter 1.1s ease-out";
      video.style.willChange = "transform, filter, scale";
      //video.style.backfaceVisibility = "hidden";
      //video.style.perspective = "10000px";
      //video.style.transformStyle = "preserve-3d";
      //video.style.transformOrigin = "center center";
      video.style.filter = `brightness(${1 + avg / 80}) contrast(${1 + avg / 200}) invert(${avg / 3000}) saturate(${avg / 50})`;
   
      //video.style.filter = `brightness(${1 + avg / 200}) invert(${avg}deg)`;
   
    }
  </script>

</section>
